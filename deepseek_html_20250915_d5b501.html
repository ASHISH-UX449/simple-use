<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Auth with Google Sign-In</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            width: 100%;
            max-width: 450px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }
        
        .header {
            background: #4a5568;
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 24px;
            font-weight: 600;
        }
        
        .form-container {
            padding: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #2d3748;
        }
        
        .form-group input {
            width: 100%;
            padding: 14px;
            border: 1px solid #cbd5e0;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }
        
        .btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s, transform 0.2s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #e2e8f0;
            color: #4a5568;
            margin-top: 10px;
        }
        
        .btn-secondary:hover {
            background: #cbd5e0;
        }
        
        .btn-google {
            background: #fff;
            color: #757575;
            border: 1px solid #ddd;
        }
        
        .btn-google:hover {
            background: #f5f5f5;
            transform: translateY(-2px);
        }
        
        .form-footer {
            text-align: center;
            margin-top: 20px;
            color: #718096;
        }
        
        .form-footer a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
        }
        
        .form-footer a:hover {
            text-decoration: underline;
        }
        
        .message {
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            text-align: center;
            display: none;
        }
        
        .success {
            background: #c6f6d5;
            color: #2d7044;
            border: 1px solid #9ae6b4;
        }
        
        .error {
            background: #fed7d7;
            color: #c53030;
            border: 1px solid #feb2b2;
        }
        
        .user-info {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .user-info h2 {
            margin-bottom: 15px;
            color: #2d3748;
        }
        
        .verified-badge {
            display: inline-block;
            background: #48bb78;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            margin-left: 8px;
        }
        
        .not-verified {
            display: inline-block;
            background: #e53e3e;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            margin-left: 8px;
        }
        
        .resend-link {
            color: #667eea;
            cursor: pointer;
            text-decoration: underline;
            margin-top: 10px;
            display: inline-block;
        }
        
        .divider {
            display: flex;
            align-items: center;
            margin: 20px 0;
        }
        
        .divider::before,
        .divider::after {
            content: "";
            flex: 1;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .divider span {
            padding: 0 10px;
            color: #718096;
            font-size: 14px;
        }
        
        .user-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin: 0 auto 15px;
            object-fit: cover;
            border: 3px solid #667eea;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Firebase Auth with Google</h1>
        </div>
        
        <div class="form-container">
            <div id="message" class="message"></div>
            
            <!-- Login Form -->
            <div id="login-form">
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" placeholder="Enter your password">
                </div>
                <button class="btn btn-primary" onclick="login()">Login</button>
                <button class="btn btn-secondary" onclick="showSignupForm()">Create New Account</button>
                
                <div class="divider"><span>Or continue with</span></div>
                
                <button class="btn btn-google" onclick="signInWithGoogle()">
                    <svg width="18" height="18" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 488 512">
                        <path fill="#4285F4" d="M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"/>
                    </svg>
                    Sign in with Google
                </button>
                
                <div class="form-footer">
                    <a href="#" onclick="resetPassword()">Forgot your password?</a>
                </div>
            </div>
            
            <!-- Signup Form -->
            <div id="signup-form" style="display: none;">
                <div class="form-group">
                    <label for="signup-email">Email</label>
                    <input type="email" id="signup-email" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label for="signup-password">Password</label>
                    <input type="password" id="signup-password" placeholder="Create a password">
                </div>
                <div class="form-group">
                    <label for="confirm-password">Confirm Password</label>
                    <input type="password" id="confirm-password" placeholder="Confirm your password">
                </div>
                <button class="btn btn-primary" onclick="signup()">Create Account</button>
                <button class="btn btn-secondary" onclick="showLoginForm()">Back to Login</button>
                
                <div class="divider"><span>Or sign up with</span></div>
                
                <button class="btn btn-google" onclick="signInWithGoogle()">
                    <svg width="18" height="18" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 488 512">
                        <path fill="#4285F4" d="M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"/>
                    </svg>
                    Sign up with Google
                </button>
            </div>
            
            <!-- User Info -->
            <div id="user-info" class="user-info">
                <img id="user-avatar" class="user-avatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23667eea'%3E%3Cpath d='M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10zm0 2c-6.627 0-12 5.373-12 12h24c0-6.627-5.373-12-12-12z'/%3E%3C/svg%3E" alt="User">
                <h2>Welcome, <span id="user-name"></span></h2>
                <p>Email: <span id="user-email"></span></p>
                <p>Status: 
                    <span id="email-verified">
                        <span class="verified-badge" id="verified-badge">Verified</span>
                        <span class="not-verified" id="not-verified" style="display: none;">Not Verified</span>
                    </span>
                </p>
                <p class="resend-link" id="resend-verification" onclick="sendVerificationEmail()">Resend Verification Email</p>
                <button class="btn btn-secondary" onclick="logout()" style="margin-top: 20px;">Logout</button>
            </div>
        </div>
    </div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCckXmWNrTXUvvTvK2eEfRXWwzsbz7fmDI",
            authDomain: "tic-tak-toe-73db7.firebaseapp.com",
            databaseURL: "https://tic-tak-toe-73db7-default-rtdb.firebaseio.com",
            projectId: "tic-tak-toe-73db7",
            storageBucket: "tic-tak-toe-73db7.firebasestorage.app",
            messagingSenderId: "151569480139",
            appId: "1:151569480139:web:4f03e4abdcff9ef1685e4e"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Show message function
        function showMessage(message, type) {
            const messageEl = document.getElementById('message');
            messageEl.textContent = message;
            messageEl.className = 'message ' + type;
            messageEl.style.display = 'block';
            
            // Hide message after 5 seconds
            setTimeout(() => {
                messageEl.style.display = 'none';
            }, 5000);
        }

        // Show login form
        function showLoginForm() {
            document.getElementById('login-form').style.display = 'block';
            document.getElementById('signup-form').style.display = 'none';
            document.getElementById('user-info').style.display = 'none';
        }

        // Show signup form
        function showSignupForm() {
            document.getElementById('login-form').style.display = 'none';
            document.getElementById('signup-form').style.display = 'block';
            document.getElementById('user-info').style.display = 'none';
        }

        // Show user info
        function showUserInfo(user) {
            document.getElementById('login-form').style.display = 'none';
            document.getElementById('signup-form').style.display = 'none';
            document.getElementById('user-info').style.display = 'block';
            
            document.getElementById('user-name').textContent = user.displayName || user.email;
            document.getElementById('user-email').textContent = user.email;
            
            // Set user avatar if available
            if (user.photoURL) {
                document.getElementById('user-avatar').src = user.photoURL;
            }
            
            if (user.emailVerified) {
                document.getElementById('verified-badge').style.display = 'inline-block';
                document.getElementById('not-verified').style.display = 'none';
                document.getElementById('resend-verification').style.display = 'none';
            } else {
                document.getElementById('verified-badge').style.display = 'none';
                document.getElementById('not-verified').style.display = 'inline-block';
                document.getElementById('resend-verification').style.display = 'block';
            }
        }

        // Signup function
        function signup() {
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            
            if (password !== confirmPassword) {
                showMessage("Passwords don't match", "error");
                return;
            }
            
            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    // Send email verification
                    sendVerificationEmail();
                    
                    // Save user to Firestore (optional)
                    db.collection("users").doc(userCredential.user.uid).set({
                        email: email,
                        createdAt: new Date()
                    })
                    .then(() => {
                        showMessage("Account created successfully! Verification email sent.", "success");
                    })
                    .catch((error) => {
                        console.error("Error saving user: ", error);
                    });
                })
                .catch((error) => {
                    showMessage(error.message, "error");
                });
        }

        // Send verification email
        function sendVerificationEmail() {
            const user = auth.currentUser;
            
            user.sendEmailVerification()
                .then(() => {
                    showMessage("Verification email sent. Please check your inbox.", "success");
                })
                .catch((error) => {
                    showMessage(error.message, "error");
                });
        }

        // Login function
        function login() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    showUserInfo(userCredential.user);
                    showMessage("Login successful!", "success");
                })
                .catch((error) => {
                    showMessage(error.message, "error");
                });
        }

        // Sign in with Google
        function signInWithGoogle() {
            const provider = new firebase.auth.GoogleAuthProvider();
            
            auth.signInWithPopup(provider)
                .then((result) => {
                    // This gives you a Google Access Token
                    const credential = result.credential;
                    const token = credential.accessToken;
                    
                    // The signed-in user info
                    const user = result.user;
                    
                    showUserInfo(user);
                    showMessage("Google sign-in successful!", "success");
                    
                    // Save user to Firestore (optional)
                    db.collection("users").doc(user.uid).set({
                        email: user.email,
                        name: user.displayName,
                        photoURL: user.photoURL,
                        createdAt: new Date()
                    })
                    .catch((error) => {
                        console.error("Error saving user: ", error);
                    });
                })
                .catch((error) => {
                    showMessage(error.message, "error");
                });
        }

        // Logout function
        function logout() {
            auth.signOut()
                .then(() => {
                    showLoginForm();
                    showMessage("You have been logged out", "success");
                })
                .catch((error) => {
                    showMessage(error.message, "error");
                });
        }

        // Reset password
        function resetPassword() {
            const email = document.getElementById('login-email').value;
            
            if (!email) {
                showMessage("Please enter your email address first", "error");
                return;
            }
            
            auth.sendPasswordResetEmail(email)
                .then(() => {
                    showMessage("Password reset email sent. Please check your inbox.", "success");
                })
                .catch((error) => {
                    showMessage(error.message, "error");
                });
        }

        // Auth state listener
        auth.onAuthStateChanged((user) => {
            if (user) {
                showUserInfo(user);
            } else {
                showLoginForm();
            }
        });
    </script>
</body>
</html>